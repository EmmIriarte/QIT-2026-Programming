{% extends 'calculator/base.html' %}

{% block title %}Calculation History{% endblock %}

{% block content %}
<div class="quantum-bg">
    <h2 class="mb-4"><i class="bi bi-clock-history"></i> Calculation History</h2>
    
    <!-- Statistics -->
    <div class="row mb-4">
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body">
                    <h3>{{ total_calculations }}</h3>
                    <p class="text-muted mb-0">Total Calculations</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body">
                    <h3 class="text-danger">{{ entangled_count }}</h3>
                    <p class="text-muted mb-0">Entangled States</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body">
                    <h3 class="text-success">{{ product_count }}</h3>
                    <p class="text-muted mb-0">Product States</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Calculations List -->
    {% if calculations %}
    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>State Name</th>
                    <th>Dimensions</th>
                    <th>Rank</th>
                    <th>Entanglement</th>
                    <th>Entropy</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for calc in calculations %}
                <tr>
                    <td>{{ calc.created_at|date:"Y-m-d H:i" }}</td>
                    <td>{{ calc.state_name|default:"---"|truncatewords:3 }}</td>
                    <td>{{ calc.dimension_a }}Ã—{{ calc.dimension_b }}</td>
                    <td><strong>{{ calc.schmidt_rank }}</strong></td>
                    <td>
                        {% if calc.is_entangled %}
                        <span class="badge bg-danger">Entangled</span>
                        {% else %}
                        <span class="badge bg-success">Product</span>
                        {% endif %}
                    </td>
                    <td>{{ calc.entropy|floatformat:4 }}</td>
                    <td>
                        <a href="{% url 'result' calc.pk %}" class="btn btn-sm btn-outline-primary">View</a>
                        <a href="{% url 'delete_calculation' calc.pk %}" class="btn btn-sm btn-outline-danger"
                           onclick="return confirm('Delete this calculation?')">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="text-center py-5">
        <i class="bi bi-inbox fs-1 text-muted"></i>
        <p class="mt-3">No calculations yet. <a href="{% url 'home' %}">Create one!</a></p>
    </div>
    {% endif %}
</div>
{% endblock %}
